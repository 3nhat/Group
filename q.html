<html>
<head>
    <title>Html-Qrcode Demo</title>
    <style>
      
      
      .button_scan {
        font-size: 50px;
      }
      #khung_qr-reader {
        font-size: 50px;
      }
      
      #khung1_qr-reader {
        width:100%;
        margin-left: auto;
        margin-right: auto;
      }
    </style>
<body>
<button type="button" class="button_scan" onclick="napFunction()">Stop Scanning Q</button>
<button type="button" class="button_scan" onclick="window['Func_Quang'](']QQQ[]QQQ[qr-reader')">Start Scanning Q</button>
<div id="khung_qr-reader" style="overflow: hidden; width:100%;">
	<div id="khung1_qr-reader">
    	<div id="qr-reader" style="width:100%;"></div>
	</div>
</div>

</body>
<!--
<script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
-->
<script src="https://3nhat.github.io/JS/html5-qrcode.min.js"></script>
<script>
function EID(NameID) {return document.getElementById(NameID);}
var h_max=161;
	//Quang("]QQQ[]QQQ[qr-reader");
    function napFunction() {
    	var str = "function Quang(x){ var arr = x.split(']QQQ['); var x1 =  arr[0]; var x2 = arr[1]; var x3 = arr[2]; function docReady(fn) { if (document.readyState === 'complete' || document.readyState === 'interactive') { setTimeout(fn, 1); } else { document.addEventListener('DOMContentLoaded', fn); } } docReady(function () { var resultContainer = EID('qr-reader-results'); var lastResult, countResults = 0; function onScanSuccess(decodedText, decodedResult) { if (decodedText !== lastResult) { ++countResults; lastResult = decodedText; if (x0!='') window[x0](x1); } } const formatsToSupport = [Html5QrcodeSupportedFormats.QR_CODE,Html5QrcodeSupportedFormats.UPC_A,Html5QrcodeSupportedFormats.UPC_E,Html5QrcodeSupportedFormats.UPC_EAN_EXTENSION]; var w = EID('qr-reader').offsetWidth/1.52; window.html5QrcodeScanner = new Html5QrcodeScanner(x3,{fps: 10,qrbox: {width: w, height: w},formatsToSupport: formatsToSupport});html5QrcodeScanner.render(onScanSuccess);});}";
        this['Func_Quang'] = new Function('return ' + str)();

    }
    
    
    function stopScan() {
  		//dotimButton("qr-reader]QQQ[Request Camera Permissions");
        //dotimSelect("qr-reader]QQQ[");
        //dotimButton("qr-reader]QQQ[Start Scanning");
        //dotimA("qr-reader]QQQ[Scan an Image File");
        //dotimALL("qr-reader]QQQ[*]QQQ[none");

	}

	function outputsize() {
		var h = EID('qr-reader').offsetHeight;
/*		
        if (h_max<h) h_max=h;
//.style.transform
  		var ot = (h<180) ? 0 : h_max/4;
  		EID('khung_qr-reader').style.marginTop = (h<180) ? "-150px" : "0px";
  
 		EID('khung_qr-reader').style.height = (h<180) ? 4*h/2 + 'px': 0.4*h + 'px';
 
 		//EID('khung1_qr-reader').style.transform = (h<180) ? "scale(1.8)" : "scale(1)";
 		EID('khung1_qr-reader').style.height = (h<180) ? 5*h/4 + 'px' : h + "px";
  
  		EID('khung1_qr-reader').style.marginTop = -1*ot + 'px';
 		//width.value = textbox.offsetWidth
 		//height.value = textbox.offsetHeight
        
*/
	}

	new ResizeObserver(outputsize).observe(EID('qr-reader'));

/*
	window.window['Func_Quang'] = function Quang(x){
    	var arr = x.split("]QQQ[");
    	var x1 =  arr[0];
    	var x2 = arr[1];
    	var x3 = arr[2];

    	function docReady(fn) {
        	if (document.readyState === "complete"
            	|| document.readyState === "interactive") {
            	setTimeout(fn, 1);
        	} else {
            	document.addEventListener("DOMContentLoaded", fn);
        	}
    	}

    	docReady(function () {
        	var resultContainer = EID('qr-reader-results');
        	var lastResult, countResults = 0;
        	function onScanSuccess(decodedText, decodedResult) {
            	if (decodedText !== lastResult) {
                	++countResults;
                	lastResult = decodedText;
                	if (x0!="") window[x0](x1);
            	}
        	}
		
        	const formatsToSupport = [
  				Html5QrcodeSupportedFormats.QR_CODE,
  				Html5QrcodeSupportedFormats.UPC_A,
  				Html5QrcodeSupportedFormats.UPC_E,
  				Html5QrcodeSupportedFormats.UPC_EAN_EXTENSION
				];

        	var w = EID("qr-reader").offsetWidth/1.52;
        
        	window.html5QrcodeScanner = new Html5QrcodeScanner(
            	x3, 
                {
    			fps: 10,
    			qrbox: {width: w, height: w},
    			formatsToSupport: formatsToSupport
  			});
                        
            
        	html5QrcodeScanner.render(onScanSuccess);
    	});
	}
*/	
	function dotimButton(para) {
        var arr = para.split("]QQQ[");
    	//const nodeList = document.querySelectorAll("button");
        const nodeList = EID(arr[0]).querySelectorAll("button");
		for (var i = 0; i < nodeList.length; i++) {
            var bt_name = nodeList[i].innerHTML;
            if (bt_name == arr[1]) {
            	nodeList[i].click();
                break;
            }
		}
    }
    function dotimSelect(para) {
    	var arr = para.split("]QQQ[");
    	const nodeList = EID(arr[0]).querySelectorAll("select");
		for (var i = 0; i < nodeList.length; i++) {
            alert(nodeList[i].innerHTML);
            var opt = nodeList[i].options;;
            var v = opt[opt.length-1].value;
            alert(v);
			nodeList[i].value = v;
		}
    }
    function dotimA(para) {
    	var arr = para.split("]QQQ[");
    	const nodeList = EID(arr[0]).querySelectorAll("a");
		for (var i = 0; i < nodeList.length; i++) {
            var a_name = nodeList[i].innerHTML;
            alert(a_name);
            if (a_name == arr[1]) {
            	//nodeList[i].click();
                //break;
            }
		}
    }
    function dotimALL(para) {
    	var arr = para.split("]QQQ[");
    	const nodeList = EID(arr[0]).querySelectorAll(arr[1]);
		for (var i = 0; i < nodeList.length; i++) {
            nodeList[i].style.display = arr[2];
            
		}
    }
</script>
</head>
</html>
